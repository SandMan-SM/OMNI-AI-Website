FEATURE IMPLEMENTATION SPEC â€” USER & ADMIN + ONBOARDING
âœ… 1 â€” Role Management & Admin Access
Supabase Schema Update

Update your users table:

ALTER TABLE users
ADD COLUMN role TEXT DEFAULT 'user';


Mark the admin:

UPDATE users
SET role = 'admin'
WHERE email = 'sitanim6@gmail.com';

âœ… 2 â€” Protect Routes Based on Role

In your Next.js auth middleware:

import { withPageAuth } from '@supabase/auth-helpers-nextjs';

export default withPageAuth({
  redirectTo: '/login'
});


Then enforce admin auth on /admin:

export async function getServerSideProps({ req }) {
  const { user } = await supabase.auth.api.getUserByCookie(req);
  if (user?.role !== 'admin') {
    return { redirect: { destination: '/', permanent: false } };
  }
  return { props: {} };
}

âœ… 3 â€” Landing Page (instead of /landingpage)

Use route:

/join


Replace old landing routes in router config.

âœ… 4 â€” Onboarding Form Flow
Signup Form (Step 1)

Structure:

âš¡ Email
âš¡ Password
[Submit]

On submit:

await supabase.auth.signUp({ email, password });


Then redirect to:

/join

Step 2 (On /join) â€” Progressive Form

The form has steps:

Step A â€” Basic Info
<input placeholder="Name" required />
<input placeholder="Phone" required />

Step B â€” Business Owner
<label>Are you a business owner?</label>
<button onClick={() => setBusiness(true)}>Yes</button>
<button onClick={() => setBusiness(false)}>No</button>


If business === true, show:

<input placeholder="Business Name" required />
<input placeholder="Business Niche" required />
<textarea placeholder="Business Details" />


Save to Supabase:

await supabase
  .from('users')
  .update({
    name,
    phone,
    business_owner: business,
    business_name,
    business_niche,
    business_details
  })
  .eq('id', user.id);

âœ… 5 â€” â€œSkipâ€ Feature

Anywhere on the onboarding form:

<button onClick={() => router.push('/dashboard')}>
  Skip & Go to Dashboard
</button>


This should still save whatever info exists before navigation.

ğŸ¯ 6 â€” Activation Step â€” YES / NO + Platforms UI

Add after onboarding fields:

Activation Prompt UI
<label>Activate Now?</label>
<button onClick={() => setActivateNow(true)}>Yes</button>
<button onClick={() => setActivateNow(false)}>No</button>


If activateNow:

Render a scrollable list of platforms:

Platforms Array
const platforms = [
  "TikTok",
  "Facebook",
  "YouTube",
  "Instagram",
  "LinkedIn",
  "X",
  "Snapchat",
  "Slack",
  "Telegram",
  "WhatsApp",
  "Newsletter",
  "Google",
  "Discord",
  "ChatGPT",
  "Spotify",
  "Zoom",
  "GitHub",
  "Apple"
];


Render 4 at a time:

{platforms.slice(index, index+4).map(platform => (
  <PlatformCard name={platform} />
))}


Each item:

const PlatformCard = ({ name }) => (
  <div className="flex items-center gap-2">
    <span className="dot red"></span>
    <p>{name}</p>
  </div>
);


Add legend:

ğŸ”´ Needs configuration  
ğŸŸ¢ Activated


Once all 18 platforms become green:

<button>Activation Complete</button>


Store activated state in Supabase:

await supabase
  .from('users')
  .update({ activated_platforms: platforms })
  .eq('id', user.id);

âœ” 7 â€” Form Submit Loading States

Wrap each async action in a loading UI:

{isLoading && <Loader />}


Use a 3-step progress bar:

[Step 1] Sign Up â†’ [Step 2] Complete Account â†’ [Step 3] Activate Now


Update real-time as each part saves.

âœ” 8 â€” Dashboard Redirect After Signup

After user finishes /join:

router.push('/dashboard');


Ensure dashboard.js checks:

const { user } = await supabase.auth.getUser();
if (!user) router.push('/login');

ğŸ¯ 9 â€” Complete Account Prompt in Profile

On /profile:

{!user.name || !user.phone ? (
  <Link href="/join">Complete Account Setup</Link>
) : null}


This reminds users to finish onboarding.

ğŸ›¡ï¸ 10 â€” Admin Portal (/admin)

Render admin interface:

<h1>Admin Panel</h1>

<table>
  {users.map(u => (
    <tr>
      <td>{u.email}</td>
      <td>{u.role}</td>
      <td>
        <button onClick={() => makeAdmin(u.id)}>Make Admin</button>
      </td>
    </tr>
  ))}
</table>


Admin actions:

const makeAdmin = async (id) =>
  await supabase
    .from('users')
    .update({ role: 'admin' })
    .eq('id', id);

âœ… Summary of Required Code Tasks

âœ” Distinguish admin from user on protected routes
âœ” Add Supabase role field & admin user
âœ” Modify onboarding flow at /join
âœ” Conditional business fields
âœ” â€œSkipâ€ onboarding option
âœ” Activation UI with 4 platforms at a time logic
âœ” Save all inputs progressively to Supabase
âœ” Redirect to /dashboard
âœ” Complete account prompts
âœ” Admin panel to manage users